---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title || "Blog Post"}>
  <main class="blog-post-content content">
    <article class="card">
      {post.data.image && <img src={post.data.image} alt={post.data.title || "Blog Post"} class="featured-image" />}
      {post.data.title && <h1>{post.data.title}</h1>}
      <p class="date">{post.data.date.toLocaleDateString()}</p>
      {post.data.video && (
        <div class="video-container">
          <iframe src={post.data.video} frameborder="0" allowfullscreen></iframe>
        </div>
      )}
      <div class="prose">
        <Content />
      </div>
    </article>
    <div style="text-align: center; margin-top: 2rem;">
        <a href="/blog" class="back-link">‚Üê Back to Blog</a>
    </div>
  </main>
</Layout>

<style>
  .blog-post-content {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
  }
  .featured-image {
    width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    margin-bottom: 2rem;
  }
  .date {
    color: #888;
    margin-bottom: 2rem;
  }
  .prose {
    line-height: 1.8;
  }
  .video-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 */
    height: 0;
    margin-bottom: 2rem;
  }
  .video-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: var(--radius-md);
  }
  .back-link {
      color: var(--color-secondary);
      text-decoration: none;
      font-weight: bold;
  }
</style>
